<section id="final" class="finalSection px-5 pb-28 section-feather bg-pastel-final min-h-[50svh] flex items-center justify-center">
  <div class="mx-auto w-full max-w-3xl text-center">
    <p class="finalKicker">V jednom obyÄajnom momenteâ€¦</p>

    <h2 class="finalTitle mt-5">
      BudeÅ¡ mojou
      <span class="block">ValentÃ­nkou?</span>
    </h2>

    <p class="finalLead mt-6">
      Klikni Ãºprimne.
      <br />
      Ja uÅ¾ aj tak tuÅ¡Ã­m odpoveÄ. ğŸ˜Œ
    </p>

    <div class="finalDivider mt-10" aria-hidden="true">
      <span></span><i>â™¥</i><span></span>
    </div>

    <div class="mt-10 finalActionsGrid">
  <div class="yesZone">
    <button id="yesBtn" class="finalYes group" type="button">
      <span class="finalYesGlow"></span>
      <span class="finalYesText">ÃNO ğŸ’—</span>
    </button>
  </div>

  <div class="noZone">
    <button id="noBtn" class="finalNo" type="button">
      Nieâ€¦
    </button>
  </div>
</div>


    <div id="afterYes" class="finalAfter mt-10 hidden" role="status" aria-live="polite">
      <p class="finalAfterTitle">YES! ğŸ¥¹ğŸ’</p>
      <p class="finalAfterText">Tak teraz uÅ¾ len pusa a plÃ¡n na veÄer.</p>
    </div>
  </div>
</section>

<script>
  import confetti from "canvas-confetti";

  const yes = document.getElementById("yesBtn");
  const no = document.getElementById("noBtn");
  const after = document.getElementById("afterYes");

  const prefersReduced =
    typeof window !== "undefined" &&
    window.matchMedia &&
    window.matchMedia("(prefers-reduced-motion: reduce)").matches;

  yes?.addEventListener("click", () => {
    // jemnejÅ¡ie konfety (stÃ¡le cute)
    confetti({
      particleCount: 110,
      spread: 65,
      origin: { y: 0.72 },
      shapes: ["heart"],
      colors: ["#E86A8D", "#F4A6B8", "#FFD1E8"],
    });

    after?.classList.remove("hidden");
    after?.classList.add("is-on");

    // â€œNieâ€¦â€ zjemnÃ­me a zneÅ¡kodnÃ­me
    no?.setAttribute("disabled", "true");
    no?.classList.add("is-disabled");
  });

  // ElegantnÃ© â€œuhÃ½banieâ€ â€“ len trochu, nech to pÃ´sobÃ­ hravo, nie chaoticky
  const nudgeNo = () => {
  if (!no || prefersReduced) return;

  const zone = no.parentElement;
  if (!zone) return;

  const maxX = zone.clientWidth - no.clientWidth;
  const maxY = zone.clientHeight - no.clientHeight;

  const x = Math.random() * Math.max(0, maxX);
  const y = Math.random() * Math.max(0, maxY);

  no.style.transform = `translate(${x}px, ${y}px)`;
};


  no?.addEventListener("mouseenter", nudgeNo);
  no?.addEventListener(
    "touchstart",
    (e) => {
      if (prefersReduced) return;
      e.preventDefault();
      nudgeNo();
    },
    { passive: false }
  );
</script>
